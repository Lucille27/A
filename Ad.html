<!DOCTYPE html>
<html lang="ar">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0"> <title>Ø±ÙØ¹ Ø§Ù„Ø£Ø³Ø¦Ù„Ù‡ Ø¥Ù„Ù‰ Ù‚Ø§Ø¹Ø¯Ø© Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª </title>
<style>
  /* ØªØµÙ…ÙŠÙ… CSS Ù…Ø¯Ù…Ø¬ */
  body { 
    font-family: Tahoma, Arial, sans-serif; 
    direction: rtl; 
    text-align: right; 
    background-color: #f4f4f9; 
    padding: 20px; 
    line-height: 1.6;
  }
  .container { 
    max-width: 600px; 
    margin: 0 auto; 
    background-color: #ffffff; 
    padding: 30px; 
    border-radius: 10px; 
    box-shadow: 0 6px 15px rgba(0, 0, 0, 0.1); 
  }
  h2 { 
    color: #007bff; 
    border-bottom: 2px solid #eee; 
    padding-bottom: 15px; 
    margin-bottom: 20px;
    text-align: center;
  }
  label { 
    display: block; 
    margin-top: 20px; 
    margin-bottom: 5px;
    font-weight: bold; 
    color: #333; 
    font-size: 1.05em;
  }
  input[type="text"], input[type="number"], select { 
    width: 100%; 
    padding: 12px; 
    border: 1px solid #ccc; 
    border-radius: 6px; 
    box-sizing: border-box;
    font-size: 1em;
  }
  .options-group {
      border: 1px solid #ddd;
      padding: 15px;
      border-radius: 6px;
      margin-top: 20px;
      margin-bottom: 20px; 
  }
  button { 
    background-color: #007bff; 
    color: white; 
    padding: 15px 20px; 
    border: none; 
    border-radius: 6px; 
    cursor: pointer; 
    margin-top: 30px; 
    font-size: 1.1em; 
    transition: background-color 0.3s; 
    width: 100%; 
  }
  button:hover:not(:disabled) { 
    background-color: #0056b3; 
  }
  button:disabled { 
    background-color: #a0c4ff; 
    cursor: not-allowed; 
  }
  #status { 
    margin-top: 25px; 
    padding: 15px; 
    border-radius: 6px; 
    font-weight: bold; 
    text-align: center; 
  }
  .status-success { 
    background-color: #d4edda; 
    color: #155724; 
    border: 1px solid #c3e6cb; 
    animation: fadeIn 0.5s ease-in; 
  }
  .status-error { 
    background-color: #f8d7da; 
    color: #721c24; 
    border: 1px solid #f5c6cb; 
    animation: shake 0.5s ease-in; 
  }
  small {
      display: block;
      color: #777;
      margin-top: 5px;
  }
  
  /* ØªØ¹Ø±ÙŠÙ ØªØ£Ø«ÙŠØ±Ø§Øª Ø§Ù„Ù€Animation */
  @keyframes fadeIn { from {opacity:0} to {opacity:1} }
  @keyframes shake { 
      0%, 100% { transform: translateX(0); } 
      25%,75% { transform: translateX(-5px); } 
      50% { transform: translateX(5px); } 
  }
  
  /* *** ØªØ¹Ø¯ÙŠÙ„Ø§Øª Ø§Ù„ØªØ¬Ø§ÙˆØ¨ÙŠØ© (Responsiveness) *** */
  @media (max-width: 768px) {
    .container {
      margin: 10px; 
      padding: 20px; 
      box-shadow: 0 4px 10px rgba(0, 0, 0, 0.1); /* Ø¸Ù„ Ø£Ø®Ù */
    }
    body {
        padding: 10px;
    }
  }

  @media (max-width: 480px) {
    h2 {
      font-size: 1.4em;
    }
    button {
      padding: 12px 15px;
      font-size: 1em;
    }
    input[type="text"], input[type="number"], select {
      padding: 10px;
    }
  }
  
</style>
</head>
<body>
<div class="container">
  <h2>Ø±ÙØ¹ Ø³Ø¤Ø§Ù„ Ø¬Ø¯ÙŠØ¯ ğŸ“</h2>
  <form id="questionForm">
    
    <label for="question">Ø§Ù„Ø³Ø¤Ø§Ù„:</label>
    <input type="text" id="question" required placeholder="ÙŠØ±Ø¬Ù‰ Ø¥Ø¯Ø®Ø§Ù„ Ù†Øµ Ø§Ù„Ø³Ø¤Ø§Ù„ Ù‡Ù†Ø§">

    <div class="options-group">
      <label for="option1">Ø§Ù„Ø®ÙŠØ§Ø± Ø§Ù„Ø£ÙˆÙ„:</label>
      <input type="text" id="option1" required>

      <label for="option2">Ø§Ù„Ø®ÙŠØ§Ø± Ø§Ù„Ø«Ø§Ù†ÙŠ:</label>
      <input type="text" id="option2" required>

      <label for="option3">Ø§Ù„Ø®ÙŠØ§Ø± Ø§Ù„Ø«Ø§Ù„Ø«:</label>
      <input type="text" id="option3" required>

      <label for="option4">Ø§Ù„Ø®ÙŠØ§Ø± Ø§Ù„Ø±Ø§Ø¨Ø¹:</label>
      <input type="text" id="option4" required>
    </div>
    
    <label for="correctAnswerSelect">Ø§Ù„Ø¥Ø¬Ø§Ø¨Ø© Ø§Ù„ØµØ­ÙŠØ­Ø©:</label>
    <select id="correctAnswerSelect" required>
        <option value="" disabled selected>Ø§Ø®ØªØ± Ø§Ù„Ø¥Ø¬Ø§Ø¨Ø© Ø§Ù„ØµØ­ÙŠØ­Ø© Ù…Ù† Ø§Ù„Ø®ÙŠØ§Ø±Ø§Øª Ø£Ø¹Ù„Ø§Ù‡</option>
    </select>

    <label for="score">Ø§Ù„Ø¯Ø±Ø¬Ø©:</label>
    <input type="number" id="score" value="1" min="1" required>
    
    <label for="time">Ø§Ù„ÙˆÙ‚Øª Ø§Ù„Ù…Ø®ØµØµ (Ø¨Ø§Ù„Ø«ÙˆØ§Ù†ÙŠ):</label>
    <input type="number" id="time" value="60" min="2" required> <small>ÙŠØ¬Ø¨ Ø£Ù† ÙŠÙƒÙˆÙ† 2 Ø«Ø§Ù†ÙŠØ© Ø¹Ù„Ù‰ Ø§Ù„Ø£Ù‚Ù„.</small> <button type="submit" id="submitButton">Ø±ÙØ¹ Ø§Ù„Ø³Ø¤Ø§Ù„</button>
  </form>

  <p id="status"></p>
</div>

<script>
const WEB_APP_URL = 'https://script.google.com/macros/s/AKfycbwxIqYIXPyAsdO8NhD9pyg0A-y_tNP0ZkhcmQ69ReArPZtwXaj577KEGuLoObS2Mr8/exec'; 
const questionForm = document.getElementById('questionForm');
const statusDisplay = document.getElementById('status');
const submitButton = document.getElementById('submitButton');
const correctAnswerSelect = document.getElementById('correctAnswerSelect');

const optionInputs = [
    document.getElementById('option1'),
    document.getElementById('option2'),
    document.getElementById('option3'),
    document.getElementById('option4')
];

// **********************************************
// 2. ØªØ­Ø³ÙŠÙ† Ø§Ù„Ù‚Ø§Ø¦Ù…Ø© Ø§Ù„Ù…Ù†Ø³Ø¯Ù„Ø©: Ø§Ù„ØªØ­Ø¯ÙŠØ« Ø¨Ø¯Ù„ Ø¥Ø¹Ø§Ø¯Ø© Ø§Ù„Ø¨Ù†Ø§Ø¡
// **********************************************
function updateCorrectAnswerOptions() {
    const selectedValue = correctAnswerSelect.value;
    
    // Ø¥Ù†Ø´Ø§Ø¡ Ø§Ù„Ø®ÙŠØ§Ø± Ø§Ù„Ø§ÙØªØ±Ø§Ø¶ÙŠ Ø¥Ø°Ø§ Ù„Ù… ÙŠÙƒÙ† Ù…ÙˆØ¬ÙˆØ¯Ø§Ù‹
    let defaultOption = correctAnswerSelect.querySelector('option[value=""][disabled]');
    if (!defaultOption) {
        defaultOption = document.createElement('option');
        defaultOption.value = "";
        defaultOption.textContent = "Ø§Ø®ØªØ± Ø§Ù„Ø¥Ø¬Ø§Ø¨Ø© Ø§Ù„ØµØ­ÙŠØ­Ø© Ù…Ù† Ø§Ù„Ø®ÙŠØ§Ø±Ø§Øª Ø£Ø¹Ù„Ø§Ù‡";
        defaultOption.disabled = true;
        defaultOption.selected = true;
        // Ù‚Ù… Ø¨Ø¥Ø¯Ø®Ø§Ù„Ù‡ ÙÙŠ Ø§Ù„Ø¨Ø¯Ø§ÙŠØ©
        if (correctAnswerSelect.firstChild) {
            correctAnswerSelect.insertBefore(defaultOption, correctAnswerSelect.firstChild);
        } else {
            correctAnswerSelect.appendChild(defaultOption);
        }
    }

    // ØªØ­Ø¯ÙŠØ« Ø§Ù„Ø¹Ù†Ø§ØµØ± Ø§Ù„Ù…ÙˆØ¬ÙˆØ¯Ø© (Ø£Ø¯Ø§Ø¡ Ø£ÙØ¶Ù„)
    optionInputs.forEach((input, index) => {
        // Ø§Ù„Ø¨Ø­Ø« Ø¹Ù† Ø§Ù„Ø¹Ù†ØµØ± Ø¨Ø§Ø³ØªØ®Ø¯Ø§Ù… data-index
        let option = correctAnswerSelect.querySelector(`option[data-index="${index}"]`);
        
        if(!option) {
            // Ø¥Ø°Ø§ Ù„Ù… ÙŠÙƒÙ† Ù…ÙˆØ¬ÙˆØ¯Ø§Ù‹ØŒ Ù‚Ù… Ø¨Ø¥Ù†Ø´Ø§Ø¦Ù‡ (Ø¨Ø¹Ø¯ Ø§Ù„Ø®ÙŠØ§Ø± Ø§Ù„Ø§ÙØªØ±Ø§Ø¶ÙŠ)
            option = document.createElement('option');
            option.setAttribute('data-index', index);
            correctAnswerSelect.appendChild(option);
        }
        
        const optionText = input.value.trim();
        option.value = optionText;
        option.textContent = optionText ? `Ø§Ù„Ø®ÙŠØ§Ø± ${index + 1}: ${optionText}` : `Ø§Ù„Ø®ÙŠØ§Ø± ${index + 1} (ÙØ§Ø±Øº)`;
        
        // Ø¥Ø®ÙØ§Ø¡ Ø§Ù„Ø®ÙŠØ§Ø± Ø¥Ø°Ø§ ÙƒØ§Ù† ÙØ§Ø±ØºØ§Ù‹ Ù„Ù…Ù†Ø¹ Ø§Ø®ØªÙŠØ§Ø± Ø®ÙŠØ§Ø± ØºÙŠØ± Ù…ÙˆØ¬ÙˆØ¯
        option.style.display = optionText ? '' : 'none';
    });

    // Ø§Ø³ØªØ¹Ø§Ø¯Ø© Ø§Ù„Ù‚ÙŠÙ…Ø© Ø§Ù„Ù…Ø®ØªØ§Ø±Ø© Ø¥Ù† ÙˆØ¬Ø¯ØªØŒ Ø£Ùˆ Ø§Ù„Ø¹ÙˆØ¯Ø© Ù„Ù„Ù‚ÙŠÙ…Ø© Ø§Ù„Ø§ÙØªØ±Ø§Ø¶ÙŠØ©
    if (selectedValue && correctAnswerSelect.querySelector(`option[value="${selectedValue}"]`)) {
        correctAnswerSelect.value = selectedValue;
    } else {
        correctAnswerSelect.value = "";
    }
}

// ØªØ´ØºÙŠÙ„ Ø§Ù„ØªØ­Ø¯ÙŠØ« Ø¹Ù†Ø¯ Ø§Ù„Ø¥Ø¯Ø®Ø§Ù„
optionInputs.forEach(input => {
    input.addEventListener('input', updateCorrectAnswerOptions);
});

updateCorrectAnswerOptions(); 

// **********************************************
// 1. Ù…Ø¹Ø§Ù„Ø¬Ø© Ø§Ù„Ø¥Ø±Ø³Ø§Ù„ (ØªØ£ÙƒÙŠØ¯ØŒ ØªØ­Ù‚Ù‚ØŒ Ø£Ù…Ø§Ù†)
// **********************************************
questionForm.addEventListener('submit', function(e){
  e.preventDefault();

  const data = {
    question: document.getElementById('question').value.trim(),
    option1: document.getElementById('option1').value.trim(),
    option2: document.getElementById('option2').value.trim(),
    option3: document.getElementById('option3').value.trim(),
    option4: document.getElementById('option4').value.trim(),
    correctAnswer: correctAnswerSelect.value.trim(), 
    score: parseInt(document.getElementById('score').value),
    time: parseInt(document.getElementById('time').value)
  };

  // *************
  // 3. ØªØ­Ù‚Ù‚ Ù…Ù† Ø§Ù„Ø£Ù…Ø§Ù†: Ø§Ù„ØªØ£ÙƒØ¯ Ù…Ù† Ø£Ù† Ø¬Ù…ÙŠØ¹ Ø§Ù„Ø­Ù‚ÙˆÙ„ Ø§Ù„Ù†ØµÙŠØ© Ù…Ù…Ù„ÙˆØ¡Ø©
  // *************
  if(!data.question || !data.option1 || !data.option2 || !data.option3 || !data.option4 || !data.correctAnswer) {
      alert('âš ï¸ ÙŠØ¬Ø¨ Ù…Ù„Ø¡ Ø¬Ù…ÙŠØ¹ Ø§Ù„Ø­Ù‚ÙˆÙ„ Ø§Ù„Ù†ØµÙŠØ© ÙˆØ§Ø®ØªÙŠØ§Ø± Ø§Ù„Ø¥Ø¬Ø§Ø¨Ø© Ø§Ù„ØµØ­ÙŠØ­Ø©!');
      return;
  }
  
  // *************
  // 1. ØªØ­Ù‚Ù‚ Ù…Ù† Ø§Ù„Ù‚ÙŠÙ… Ø§Ù„Ø±Ù‚Ù…ÙŠØ© (ØªÙ… ØªØ­Ø¯ÙŠØ« Ø§Ù„Ø­Ø¯ Ø§Ù„Ø£Ø¯Ù†Ù‰ Ø¥Ù„Ù‰ 2 Ø«Ø§Ù†ÙŠØ©)
  // *************
  if(isNaN(data.time) || data.time < 2) {
      alert('Ø§Ù„ÙˆÙ‚Øª Ø§Ù„Ù…Ø®ØµØµ ØºÙŠØ± ØµØ§Ù„Ø­. ÙŠØ¬Ø¨ Ø£Ù† ÙŠÙƒÙˆÙ† 2 Ø«Ø§Ù†ÙŠØ© Ø¹Ù„Ù‰ Ø§Ù„Ø£Ù‚Ù„.');
      return;
  }
  if(isNaN(data.score) || data.score < 1) {
      alert('Ø§Ù„Ø¯Ø±Ø¬Ø© ØºÙŠØ± ØµØ§Ù„Ø­Ø©. ÙŠØ¬Ø¨ Ø£Ù† ØªÙƒÙˆÙ† 1 Ø¹Ù„Ù‰ Ø§Ù„Ø£Ù‚Ù„.');
      return;
  }

  // *************
  // 1. ØªØ£ÙƒÙŠØ¯ Ù‚Ø¨Ù„ Ø§Ù„Ø¥Ø±Ø³Ø§Ù„ (UX)
  // *************
  if (!confirm('Ù‡Ù„ Ø£Ù†Øª Ù…ØªØ£ÙƒØ¯ Ù…Ù† Ø±ÙØ¹ Ù‡Ø°Ø§ Ø§Ù„Ø³Ø¤Ø§Ù„ØŸ')) {
      return;
  }

  // Ø­Ø§Ù„Ø© Ø§Ù„ØªØ­Ù…ÙŠÙ„
  submitButton.disabled = true;
  submitButton.textContent = 'Ø¬Ø§Ø±ÙŠ Ø§Ù„Ø±ÙØ¹... â³';
  statusDisplay.className = '';
  statusDisplay.innerText = 'ÙŠÙØ±Ø¬Ù‰ Ø§Ù„Ø§Ù†ØªØ¸Ø§Ø±...';

  fetch(WEB_APP_URL, {
    method: 'POST',
    body: JSON.stringify(data) 
  })
  .then(response => response.json())
  .then(result => {
    if (result.status === 'success') {
        statusDisplay.innerText = 'âœ… ØªÙ… Ø±ÙØ¹ Ø§Ù„Ø³Ø¤Ø§Ù„ Ø¨Ù†Ø¬Ø§Ø­! Ø¬Ø§Ù‡Ø² Ù„Ù„Ø³Ø¤Ø§Ù„ Ø§Ù„ØªØ§Ù„ÙŠ.';
        statusDisplay.className = 'status-success';
        questionForm.reset();
        // Ø¥Ø¹Ø§Ø¯Ø© ØªÙ‡ÙŠØ¦Ø© Ø§Ù„Ù‚Ø§Ø¦Ù…Ø© Ø§Ù„Ù…Ù†Ø³Ø¯Ù„Ø©
        updateCorrectAnswerOptions(); 
    } else {
        statusDisplay.innerText = 'âŒ Ø®Ø·Ø£: ' + (result.message || 'Ø­Ø¯Ø« Ø®Ø·Ø£ ØºÙŠØ± Ù…Ø¹Ø±ÙˆÙ ÙÙŠ Ø§Ù„Ø³ÙŠØ±ÙØ±.');
        statusDisplay.className = 'status-error';
    }
  })
  .catch(error => {
    statusDisplay.innerText = 'âŒ Ø®Ø·Ø£ ÙÙŠ Ø§Ù„Ø§ØªØµØ§Ù„: ØªØ£ÙƒØ¯ Ù…Ù† Ø±Ø§Ø¨Ø· Ø§Ù„ÙˆÙŠØ¨ Ø£Ø¨ Ø£Ùˆ Ø§ØªØµØ§Ù„Ùƒ Ø¨Ø§Ù„Ø¥Ù†ØªØ±Ù†Øª.';
    statusDisplay.className = 'status-error';
    console.error('Fetch error:', error);
  })
  .finally(() => {
    submitButton.disabled = false;
    submitButton.textContent = 'Ø±ÙØ¹ Ø§Ù„Ø³Ø¤Ø§Ù„';
  });
});
</script>
</body>
</html>
